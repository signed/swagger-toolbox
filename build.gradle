buildscript {
    repositories {
        jcenter()
        mavenCentral()
    }
    dependencies {
        classpath 'com.bmuschko:gradle-nexus-plugin:2.3.1'
    }
}

plugins {
    id 'com.github.ben-manes.versions' version '0.13.0'
    id "net.saliman.cobertura" version "2.3.2"
    id "com.github.kt3k.coveralls" version "2.6.3"
}

cobertura.coverageFormats = ['html', 'xml']


apply plugin: 'java'
apply plugin: 'pmd'

if (project.hasProperty('release')) {
    apply from: "$rootDir/gradle/buildscript/central.gradle"
}

repositories {
    mavenLocal()
    mavenCentral()
    jcenter()
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

group = 'com.github.signed.swagger'
version = '0.2.0-SNAPSHOT'

pmd {
    consoleOutput = true
    ignoreFailures = true
    reportsDir = file("$project.buildDir/reports/pmd")
    ruleSetFiles = files("config/pmd/ruleset.xml")
    toolVersion = '5.4.1'
}

dependencies {
    compile(
        'io.swagger:swagger-parser:1.0.23'
        , 'com.github.fge:json-schema-validator:2.2.6'
    )
    testCompile(
        'junit:junit:4.12'
        , 'org.hamcrest:java-hamcrest:2.0.0.0'
        , 'org.mockito:mockito-core:2.2.9'
        , 'info.cukes:cucumber-java:1.2.5'
        , 'info.cukes:cucumber-junit:1.2.5'
    )
}

compileJava {
    options.encoding = 'UTF-8'
    options.compilerArgs = ['-Xlint', '-Xlint:-serial', '-Xlint:-path']
}

test {
    testLogging {
        exceptionFormat = 'full'
    }
}

task wrapper(type: Wrapper) {
    distributionUrl = 'https://services.gradle.org/distributions/gradle-3.1-all.zip'
}